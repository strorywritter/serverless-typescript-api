// Local runner for main-api function
// Usage: npx tsx src/main-api/local-run.ts [token]

import { handler } from './index.js';
import { APIGatewayProxyEvent } from 'aws-lambda';

// Load environment variables
import dotenv from 'dotenv';
dotenv.config();

// Get token from command line or use placeholder
const token = process.argv[2] || 'test-token';

// Create test event
const event: APIGatewayProxyEvent = {
  body: JSON.stringify({
      title: 'sunlight soap',
      price: 120,
      image:"data:image/jpeg;base64,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"
    // imageBase64: process.argv[3] || undefined,
    // imageFileName: process.argv[4] || undefined,
  }),
  headers: {
    Authorization: `Bearer ${token}`,
  },
  multiValueHeaders: {},
  httpMethod: 'POST',
  isBase64Encoded: false,
  path: '/data',
  pathParameters: null,
  queryStringParameters: null,
  multiValueQueryStringParameters: null,
  stageVariables: null,
  requestContext: {} as any,
  resource: '',
};

// Run the handler
handler(event)
  .then((response) => {
    console.log('\n=== Response ===');
    console.log('Status Code:', response.statusCode);
    console.log('Body:', JSON.stringify(JSON.parse(response.body), null, 2));
    process.exit(0);
  })
  .catch((error) => {
    console.error('\n=== Error ===');
    console.error(error);
    process.exit(1);
  });

